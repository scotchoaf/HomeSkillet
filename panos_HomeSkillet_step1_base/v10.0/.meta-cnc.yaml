name: homeskillet_base_panos_v10_5fdbc623-2891-4937-a577-d0aea59065cc
label: v10.0 Step 1 - HomeSkillet baseline based on IronSkillet
description: '** LOAD ME FIRST ** Homeskillet baseline configuration extracted from
    IronSkillet'
type: panos
labels:
    collection: lib
variables:
-   name: FW_NAME
    description: Firewall hostname
    default: panos-01
    type_hint: text
-   name: NTP_1
    description: Network Time Protocol Server
    default: 0.pool.ntp.org
    type_hint: text
-   name: NTP_2
    description: Network Time Protocol Server 2
    default: 1.pool.ntp.org
    type_hint: text
-   name: SINKHOLE_IPV4
    description: sinkhole FQDN IPv4
    default: sinkhole.paloaltonetworks.com
    type_hint: text
-   name: SINKHOLE_IPV6
    description: sinkhole address IPv6
    default: 2600:5200::1
    type_hint: ip_address
-   name: SYSLOG_SERVER
    description: syslog server ip address
    default: 192.0.2.2
    type_hint: text
-   name: API_KEY_LIFETIME
    description: lifetime for the api key in minutes
    default: 525600
    type_hint: text
-   name: INCLUDE_PAN_EDL
    description: include the predefined Palo Alto Networks external lists security
        rules
    default: 'no'
    type_hint: dropdown
    dd_list:
    -   key: 'yes'
        value: 'yes'
    -   key: 'no'
        value: 'no'
snippets:
-   name: device_system
    xpath: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: |-
        <update-schedule>
          <threats>
            <recurring>
              <every-30-mins>
                <at>2</at>
                <action>download-and-install</action>
              </every-30-mins>
              <threshold>48</threshold>
            </recurring>
          </threats>
          <anti-virus>
            <recurring>
              <hourly>
                <at>4</at>
                <action>download-and-install</action>
              </hourly>
            </recurring>
          </anti-virus>
          <wildfire>
            <recurring>
              <real-time/>
            </recurring>
          </wildfire>
          <global-protect-datafile>
            <recurring>
              <hourly>
                <at>40</at>
                <action>download-and-install</action>
              </hourly>
            </recurring>
          </global-protect-datafile>
          <global-protect-clientless-vpn>
            <recurring>
              <hourly>
                <at>50</at>
                <action>download-and-install</action>
              </hourly>
            </recurring>
          </global-protect-clientless-vpn>
        </update-schedule>
        <snmp-setting>
          <access-setting>
            <version>
              <v3/>
            </version>
          </access-setting>
        </snmp-setting>
        <ntp-servers>
          <primary-ntp-server>
            <ntp-server-address>{{ NTP_1 }}</ntp-server-address>
          </primary-ntp-server>
          <secondary-ntp-server>
            <ntp-server-address>{{ NTP_2 }}</ntp-server-address>
          </secondary-ntp-server>
        </ntp-servers>
        <login-banner>You have accessed a protected system.
        Log off immediately if you are not an authorized user.</login-banner>
        <timezone>UTC</timezone>
        <hostname>{{ FW_NAME }}</hostname>
    cmd: set
-   name: device_setting
    xpath: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
      <ctd>
        <tcp-bypass-exceed-queue>no</tcp-bypass-exceed-queue>
        <udp-bypass-exceed-queue>no</udp-bypass-exceed-queue>
      </ctd>
      <management>
        <enable-log-high-dp-load>yes</enable-log-high-dp-load>
        <max-rows-in-csv-export>1048576</max-rows-in-csv-export>
        <api>
          <key>
            <lifetime>{{ API_KEY_LIFETIME }}</lifetime>
          </key>
        </api>
        <admin-lockout>
          <failed-attempts>5</failed-attempts>
          <lockout-time>30</lockout-time>
        </admin-lockout>
        <idle-timeout>10</idle-timeout>
        <auto-acquire-commit-lock>yes</auto-acquire-commit-lock>
      </management>
      <wildfire>
         <file-size-limit>
          <entry name="pe">
            <size-limit>16</size-limit>
          </entry>
          <entry name="apk">
            <size-limit>30</size-limit>
          </entry>

          <entry name="pdf">
            <size-limit>3072</size-limit>
          </entry>
          <entry name="ms-office">
            <size-limit>16384</size-limit>
          </entry>
          <entry name="jar">
            <size-limit>5</size-limit>
          </entry>
          <entry name="flash">
            <size-limit>5</size-limit>
          </entry>
          <entry name="MacOSX">
            <size-limit>10</size-limit>
          </entry>
          <entry name="archive">
            <size-limit>50</size-limit>
          </entry>
          <entry name="linux">
            <size-limit>50</size-limit>
          </entry>
          <entry name="script">
            <size-limit>2000</size-limit>
          </entry>
         </file-size-limit>
        <report-benign-file>yes</report-benign-file>
        <report-grayware-file>yes</report-grayware-file>
      </wildfire>
      <config>
        <rematch>yes</rematch>
      </config>
      <application>
        <notify-user>yes</notify-user>
        <bypass-exceed-queue>no</bypass-exceed-queue>
      </application>
      <logging>
        <log-suppression>no</log-suppression>
      </logging>
      <tcp>
        <urgent-data>clear</urgent-data>
        <drop-zero-flag>yes</drop-zero-flag>
        <bypass-exceed-oo-queue>no</bypass-exceed-oo-queue>
        <check-timestamp-option>yes</check-timestamp-option>
        <strip-mptcp-option>yes</strip-mptcp-option>
      </tcp>

    cmd: set
-   name: password_complexity
    xpath: /config/mgt-config/password-complexity
    element: |-
        <enabled>yes</enabled>
        <minimum-length>12</minimum-length>
        <minimum-uppercase-letters>1</minimum-uppercase-letters>
        <minimum-lowercase-letters>1</minimum-lowercase-letters>
        <minimum-numeric-letters>1</minimum-numeric-letters>
        <minimum-special-characters>1</minimum-special-characters>
        <block-username-inclusion>yes</block-username-inclusion>
        <password-history-count>24</password-history-count>
        <new-password-differs-by-characters>3</new-password-differs-by-characters>
    cmd: set
-   name: shared_log_settings
    xpath: /config/shared/log-settings
    element: |-
        <syslog>
          <entry name="Sample_Syslog_Profile">
            <server>
              <entry name="Sample_Syslog">
                <transport>UDP</transport>
                <port>514</port>
                <format>BSD</format>
                <server>{{ SYSLOG_SERVER }}</server>
                <facility>LOG_USER</facility>
              </entry>
            </server>
          </entry>
        </syslog>
        <system>
          <match-list>
            <entry name="System_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
          </match-list>
        </system>
        <config>
          <match-list>
            <entry name="Configuration_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
          </match-list>
        </config>
        <userid>
          <match-list>
            <entry name="User-ID_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
          </match-list>
        </userid>
        <hipmatch>
          <match-list>
            <entry name="HIP_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
          </match-list>
        </hipmatch>
        <globalprotect>
          <match-list>
            <entry name="GP_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
            </entry>
          </match-list>
        </globalprotect>
        <iptag>
          <match-list>
            <entry name="IP-Tag_Log_Forwarding">
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
              <filter>All Logs</filter>
            </entry>
          </match-list>
        </iptag>
    cmd: set
-   name: tag
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/tag
    element: |-
      <entry name="Outbound">
      	<comments>Outbound to the Internet</comments>
      </entry>
      <entry name="Inbound">
      	<comments>Inbound from the Internet</comments>
      </entry>
      <entry name="Internal">
      	<comments>Internal to Internal</comments>
      </entry>
      <entry name="iron-skillet-version">
      	<comments>version 0.0.1 for 10.0: version of this IronSkillet template file</comments>
      </entry>
    cmd: set
-   name: log_settings_profiles
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/log-settings/profiles
    element: |-
        <entry name="default">
          <match-list>
            <entry name="Traffic_Log_Forwarding">
              <log-type>traffic</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
            <entry name="Threat_Log_Forwarding">
              <log-type>threat</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
            <entry name="Wildfire_Log_Forwarding">
              <log-type>wildfire</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
            <entry name="URL_Log_Forwarding">
              <log-type>url</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
            <entry name="Data_Log_Forwarding">
              <log-type>data</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
            <entry name="Tunnel_Log_Forwarding">
              <log-type>tunnel</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
            <entry name="Auth_Log_Forwarding">
              <log-type>auth</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>no</send-to-panorama>
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
            </entry>
          </match-list>
        </entry>
    cmd: set
-   name: profiles_custom_url_category
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/custom-url-category
    element: |-
        <entry name="Block">
          <type>URL List</type>
        </entry>
        <entry name="Allow">
          <type>URL List</type>
        </entry>
        <entry name="Custom-No-Decrypt">
          <type>URL List</type>
        </entry>
    cmd: set
-   name: profiles_decryption
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/decryption
    element: |-
        <entry name="Recommended_Decryption_Profile">
          <ssl-forward-proxy>
            <block-expired-certificate>yes</block-expired-certificate>
            <block-untrusted-issuer>yes</block-untrusted-issuer>
            <block-unknown-cert>yes</block-unknown-cert>
            <block-timeout-cert>yes</block-timeout-cert>
            <block-unsupported-version>yes</block-unsupported-version>
            <block-unsupported-cipher>yes</block-unsupported-cipher>
          </ssl-forward-proxy>
          <ssl-no-proxy>
            <block-expired-certificate>yes</block-expired-certificate>
            <block-untrusted-issuer>yes</block-untrusted-issuer>
          </ssl-no-proxy>
          <ssl-inbound-proxy>
            <block-unsupported-version>no</block-unsupported-version>
            <block-unsupported-cipher>no</block-unsupported-cipher>
          </ssl-inbound-proxy>
          <ssh-proxy>
            <block-unsupported-version>yes</block-unsupported-version>
            <block-unsupported-alg>yes</block-unsupported-alg>
          </ssh-proxy>
          <ssl-protocol-settings>
            <min-version>tls1-2</min-version>
            <max-version>tls1-3</max-version>
            <keyxchg-algo-rsa>no</keyxchg-algo-rsa>
            <enc-algo-3des>no</enc-algo-3des>
            <enc-algo-rc4>no</enc-algo-rc4>
            <auth-algo-sha1>no</auth-algo-sha1>
          </ssl-protocol-settings>
        </entry>
    cmd: set
-   name: profiles_virus
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/virus
    element: |-
        <entry name="Alert-Only-AV">
          <decoder>
            <entry name="ftp">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="http">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="http2">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="imap">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="pop3">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="smb">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="smtp">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable(alert-only)</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable(alert-only)</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable(alert-only)</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
        <entry name="Outbound-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
        <entry name="Inbound-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
        <entry name="Internal-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
        <entry name="Exception-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
          <description>Use this profile for rules needing modifications to the standard</description>
        </entry>
    cmd: set
-   name: profiles_spyware
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/spyware
    element: |-
        <entry name="Outbound-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <sinkhole/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Inbound-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <sinkhole/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Internal-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <sinkhole/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Block-Critical-High">
              <action>
                <reset-both/>
              </action>
              <severity>
                <member>critical</member>
                <member>high</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Medium-Low-Info">
              <action>
                <default/>
              </action>
              <severity>
                <member>medium</member>
                <member>low</member>
                <member>informational</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Alert-Only-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <alert/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Alert-All">
              <action>
                <alert/>
              </action>
              <severity>
                <member>any</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Exception-AS">
          <description>Used for exception cases not part of the recommended practice</description>
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <packet-capture>single-packet</packet-capture>
                <action>
                  <sinkhole/>
                </action>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
        </entry>
    cmd: set
-   name: profiles_vulnerability
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/vulnerability
    element: |-
        <entry name="Outbound-VP">
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Inbound-VP">
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Internal-VP">
          <rules>
            <entry name="Block-Critical-High">
              <action>
                <reset-both/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>critical</member>
                <member>high</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Medium-Low-Info">
              <action>
                <default/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>low</member>
                <member>informational</member>
                <member>medium</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Alert-Only-VP">
          <rules>
            <entry name="Alert-All">
              <action>
                <alert/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>any</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
        <entry name="Exception-VP"/>
    cmd: set
-   name: profiles_file_blocking
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/file-blocking
    element: |-
        <entry name="Outbound-FB">
          <rules>
            <entry name="Alert-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
            <entry name="Block">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>7z</member>
                <member>bat</member>
                <member>chm</member>
                <member>class</member>
                <member>cpl</member>
                <member>dll</member>
                <member>hlp</member>
                <member>hta</member>
                <member>jar</member>
                <member>ocx</member>
                <member>pif</member>
                <member>scr</member>
                <member>torrent</member>
                <member>vbe</member>
                <member>wsf</member>
              </file-type>
              <direction>both</direction>
              <action>block</action>
            </entry>
          </rules>
        </entry>
        <entry name="Inbound-FB">
          <rules>
            <entry name="Alert-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
            <entry name="Block">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>7z</member>
                <member>bat</member>
                <member>chm</member>
                <member>class</member>
                <member>cpl</member>
                <member>dll</member>
                <member>hlp</member>
                <member>hta</member>
                <member>jar</member>
                <member>ocx</member>
                <member>pif</member>
                <member>scr</member>
                <member>torrent</member>
                <member>vbe</member>
                <member>wsf</member>
              </file-type>
              <direction>both</direction>
              <action>block</action>
            </entry>
          </rules>
        </entry>
        <entry name="Internal-FB">
          <rules>
            <entry name="Alert-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
            <entry name="Block">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>7z</member>
                <member>bat</member>
                <member>chm</member>
                <member>class</member>
                <member>cpl</member>
                <member>hlp</member>
                <member>hta</member>
                <member>jar</member>
                <member>ocx</member>
                <member>pif</member>
                <member>scr</member>
                <member>torrent</member>
                <member>vbe</member>
                <member>wsf</member>
              </file-type>
              <direction>both</direction>
              <action>block</action>
            </entry>
          </rules>
        </entry>
        <entry name="Alert-Only-FB">
          <rules>
            <entry name="Alert-Only">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
          </rules>
        </entry>
    cmd: set
-   name: profiles_url_filtering
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/url-filtering
    element: |-
        <entry name="Outbound-URL">
          <credential-enforcement>
            <mode>
              <ip-user/>
            </mode>
            <log-severity>high</log-severity>
            <block>
              <member>Block</member>
              <member>Allow</member>
              <member>abortion</member>
              <member>abused-drugs</member>
              <member>adult</member>
              <member>alcohol-and-tobacco</member>
              <member>auctions</member>
              <member>business-and-economy</member>
              <member>command-and-control</member>
              <member>computer-and-internet-info</member>
              <member>content-delivery-networks</member>
              <member>copyright-infringement</member>
              <member>cryptocurrency</member>
              <member>dating</member>
              <member>dynamic-dns</member>
              <member>educational-institutions</member>
              <member>entertainment-and-arts</member>
              <member>extremism</member>
              <member>financial-services</member>
              <member>gambling</member>
              <member>games</member>
              <member>government</member>
              <member>grayware</member>
              <member>hacking</member>
              <member>health-and-medicine</member>
              <member>high-risk</member>
              <member>home-and-garden</member>
              <member>hunting-and-fishing</member>
              <member>insufficient-content</member>
              <member>internet-communications-and-telephony</member>
              <member>internet-portals</member>
              <member>job-search</member>
              <member>legal</member>
              <member>low-risk</member>
              <member>malware</member>
              <member>medium-risk</member>
              <member>military</member>
              <member>motor-vehicles</member>
              <member>music</member>
              <member>newly-registered-domain</member>
              <member>news</member>
              <member>not-resolved</member>
              <member>nudity</member>
              <member>online-storage-and-backup</member>
              <member>parked</member>
              <member>peer-to-peer</member>
              <member>personal-sites-and-blogs</member>
              <member>philosophy-and-political-advocacy</member>
              <member>phishing</member>
              <member>private-ip-addresses</member>
              <member>proxy-avoidance-and-anonymizers</member>
              <member>questionable</member>
              <member>real-estate</member>
              <member>recreation-and-hobbies</member>
              <member>reference-and-research</member>
              <member>religion</member>
              <member>search-engines</member>
              <member>sex-education</member>
              <member>shareware-and-freeware</member>
              <member>shopping</member>
              <member>social-networking</member>
              <member>society</member>
              <member>sports</member>
              <member>stock-advice-and-tools</member>
              <member>streaming-media</member>
              <member>swimsuits-and-intimate-apparel</member>
              <member>training-and-tools</member>
              <member>translation</member>
              <member>travel</member>
              <member>unknown</member>
              <member>weapons</member>
              <member>web-advertisements</member>
              <member>web-based-email</member>
              <member>web-hosting</member>
            </block>
          </credential-enforcement>
          <log-http-hdr-user-agent>yes</log-http-hdr-user-agent>
          <log-http-hdr-referer>yes</log-http-hdr-referer>
          <log-http-hdr-xff>yes</log-http-hdr-xff>
          <alert>
            <member>Allow</member>
            <member>abortion</member>
            <member>abused-drugs</member>
            <member>adult</member>
            <member>alcohol-and-tobacco</member>
            <member>auctions</member>
            <member>business-and-economy</member>
            <member>computer-and-internet-info</member>
            <member>content-delivery-networks</member>
            <member>copyright-infringement</member>
            <member>cryptocurrency</member>
            <member>dating</member>
            <member>dynamic-dns</member>
            <member>educational-institutions</member>
            <member>entertainment-and-arts</member>
            <member>extremism</member>
            <member>financial-services</member>
            <member>gambling</member>
            <member>games</member>
            <member>government</member>
            <member>hacking</member>
            <member>health-and-medicine</member>
            <member>high-risk</member>
            <member>home-and-garden</member>
            <member>hunting-and-fishing</member>
            <member>insufficient-content</member>
            <member>internet-communications-and-telephony</member>
            <member>internet-portals</member>
            <member>job-search</member>
            <member>legal</member>
            <member>low-risk</member>
            <member>medium-risk</member>
            <member>military</member>
            <member>motor-vehicles</member>
            <member>music</member>
            <member>newly-registered-domain</member>
            <member>news</member>
            <member>not-resolved</member>
            <member>nudity</member>
            <member>online-storage-and-backup</member>
            <member>parked</member>
            <member>peer-to-peer</member>
            <member>personal-sites-and-blogs</member>
            <member>philosophy-and-political-advocacy</member>
            <member>private-ip-addresses</member>
            <member>proxy-avoidance-and-anonymizers</member>
            <member>questionable</member>
            <member>real-estate</member>
            <member>recreation-and-hobbies</member>
            <member>reference-and-research</member>
            <member>religion</member>
            <member>search-engines</member>
            <member>sex-education</member>
            <member>shareware-and-freeware</member>
            <member>shopping</member>
            <member>social-networking</member>
            <member>society</member>
            <member>sports</member>
            <member>stock-advice-and-tools</member>
            <member>streaming-media</member>
            <member>swimsuits-and-intimate-apparel</member>
            <member>training-and-tools</member>
            <member>translation</member>
            <member>travel</member>
            <member>unknown</member>
            <member>weapons</member>
            <member>web-advertisements</member>
            <member>web-based-email</member>
            <member>web-hosting</member>
          </alert>
          <block>
            <member>Block</member>
            <member>command-and-control</member>
            <member>grayware</member>
            <member>malware</member>
            <member>phishing</member>
          </block>
          <mlav-engine-urlbased-enabled>
            <entry name="Phishing Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
            <entry name="Javascript Exploit Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
          </mlav-engine-urlbased-enabled>
        </entry>
        <entry name="Alert-Only-URL">
          <credential-enforcement>
            <mode>
              <ip-user/>
            </mode>
            <log-severity>medium</log-severity>
            <alert>
              <member>Block</member>
              <member>Allow</member>
              <member>abortion</member>
              <member>abused-drugs</member>
              <member>adult</member>
              <member>alcohol-and-tobacco</member>
              <member>auctions</member>
              <member>business-and-economy</member>
              <member>command-and-control</member>
              <member>computer-and-internet-info</member>
              <member>content-delivery-networks</member>
              <member>copyright-infringement</member>
              <member>cryptocurrency</member>
              <member>dating</member>
              <member>dynamic-dns</member>
              <member>educational-institutions</member>
              <member>entertainment-and-arts</member>
              <member>extremism</member>
              <member>financial-services</member>
              <member>gambling</member>
              <member>games</member>
              <member>government</member>
              <member>grayware</member>
              <member>hacking</member>
              <member>health-and-medicine</member>
              <member>high-risk</member>
              <member>home-and-garden</member>
              <member>hunting-and-fishing</member>
              <member>insufficient-content</member>
              <member>internet-communications-and-telephony</member>
              <member>internet-portals</member>
              <member>job-search</member>
              <member>legal</member>
              <member>low-risk</member>
              <member>malware</member>
              <member>medium-risk</member>
              <member>military</member>
              <member>motor-vehicles</member>
              <member>music</member>
              <member>newly-registered-domain</member>
              <member>news</member>
              <member>not-resolved</member>
              <member>nudity</member>
              <member>online-storage-and-backup</member>
              <member>parked</member>
              <member>peer-to-peer</member>
              <member>personal-sites-and-blogs</member>
              <member>philosophy-and-political-advocacy</member>
              <member>phishing</member>
              <member>private-ip-addresses</member>
              <member>proxy-avoidance-and-anonymizers</member>
              <member>questionable</member>
              <member>real-estate</member>
              <member>recreation-and-hobbies</member>
              <member>reference-and-research</member>
              <member>religion</member>
              <member>search-engines</member>
              <member>sex-education</member>
              <member>shareware-and-freeware</member>
              <member>shopping</member>
              <member>social-networking</member>
              <member>society</member>
              <member>sports</member>
              <member>stock-advice-and-tools</member>
              <member>streaming-media</member>
              <member>swimsuits-and-intimate-apparel</member>
              <member>training-and-tools</member>
              <member>translation</member>
              <member>travel</member>
              <member>unknown</member>
              <member>weapons</member>
              <member>web-advertisements</member>
              <member>web-based-email</member>
              <member>web-hosting</member>
            </alert>
          </credential-enforcement>
          <alert>
            <member>Block</member>
            <member>Allow</member>
            <member>abortion</member>
            <member>abused-drugs</member>
            <member>adult</member>
            <member>alcohol-and-tobacco</member>
            <member>auctions</member>
            <member>business-and-economy</member>
            <member>command-and-control</member>
            <member>computer-and-internet-info</member>
            <member>content-delivery-networks</member>
            <member>copyright-infringement</member>
            <member>cryptocurrency</member>
            <member>dating</member>
            <member>dynamic-dns</member>
            <member>educational-institutions</member>
            <member>entertainment-and-arts</member>
            <member>extremism</member>
            <member>financial-services</member>
            <member>gambling</member>
            <member>games</member>
            <member>government</member>
            <member>grayware</member>
            <member>hacking</member>
            <member>health-and-medicine</member>
            <member>high-risk</member>
            <member>home-and-garden</member>
            <member>hunting-and-fishing</member>
            <member>insufficient-content</member>
            <member>internet-communications-and-telephony</member>
            <member>internet-portals</member>
            <member>job-search</member>
            <member>legal</member>
            <member>low-risk</member>
            <member>malware</member>
            <member>medium-risk</member>
            <member>military</member>
            <member>motor-vehicles</member>
            <member>music</member>
            <member>newly-registered-domain</member>
            <member>news</member>
            <member>not-resolved</member>
            <member>nudity</member>
            <member>online-storage-and-backup</member>
            <member>parked</member>
            <member>peer-to-peer</member>
            <member>personal-sites-and-blogs</member>
            <member>philosophy-and-political-advocacy</member>
            <member>phishing</member>
            <member>private-ip-addresses</member>
            <member>proxy-avoidance-and-anonymizers</member>
            <member>questionable</member>
            <member>real-estate</member>
            <member>recreation-and-hobbies</member>
            <member>reference-and-research</member>
            <member>religion</member>
            <member>search-engines</member>
            <member>sex-education</member>
            <member>shareware-and-freeware</member>
            <member>shopping</member>
            <member>social-networking</member>
            <member>society</member>
            <member>sports</member>
            <member>stock-advice-and-tools</member>
            <member>streaming-media</member>
            <member>swimsuits-and-intimate-apparel</member>
            <member>training-and-tools</member>
            <member>translation</member>
            <member>travel</member>
            <member>unknown</member>
            <member>weapons</member>
            <member>web-advertisements</member>
            <member>web-based-email</member>
            <member>web-hosting</member>
          </alert>
          <mlav-engine-urlbased-enabled>
            <entry name="Phishing Detection">
              <mlav-policy-action>alert</mlav-policy-action>
            </entry>
            <entry name="Javascript Exploit Detection">
              <mlav-policy-action>alert</mlav-policy-action>
            </entry>
          </mlav-engine-urlbased-enabled>
        </entry>
        <entry name="Exception-URL">
          <credential-enforcement>
            <mode>
              <ip-user/>
            </mode>
            <log-severity>high</log-severity>
            <block>
              <member>Block</member>
              <member>Allow</member>
              <member>abortion</member>
              <member>abused-drugs</member>
              <member>adult</member>
              <member>alcohol-and-tobacco</member>
              <member>auctions</member>
              <member>business-and-economy</member>
              <member>command-and-control</member>
              <member>computer-and-internet-info</member>
              <member>content-delivery-networks</member>
              <member>copyright-infringement</member>
              <member>cryptocurrency</member>
              <member>dating</member>
              <member>dynamic-dns</member>
              <member>educational-institutions</member>
              <member>entertainment-and-arts</member>
              <member>extremism</member>
              <member>financial-services</member>
              <member>gambling</member>
              <member>games</member>
              <member>government</member>
              <member>grayware</member>
              <member>hacking</member>
              <member>health-and-medicine</member>
              <member>high-risk</member>
              <member>home-and-garden</member>
              <member>hunting-and-fishing</member>
              <member>insufficient-content</member>
              <member>internet-communications-and-telephony</member>
              <member>internet-portals</member>
              <member>job-search</member>
              <member>legal</member>
              <member>low-risk</member>
              <member>malware</member>
              <member>medium-risk</member>
              <member>military</member>
              <member>motor-vehicles</member>
              <member>music</member>
              <member>newly-registered-domain</member>
              <member>news</member>
              <member>not-resolved</member>
              <member>nudity</member>
              <member>online-storage-and-backup</member>
              <member>parked</member>
              <member>peer-to-peer</member>
              <member>personal-sites-and-blogs</member>
              <member>philosophy-and-political-advocacy</member>
              <member>phishing</member>
              <member>private-ip-addresses</member>
              <member>proxy-avoidance-and-anonymizers</member>
              <member>questionable</member>
              <member>real-estate</member>
              <member>recreation-and-hobbies</member>
              <member>reference-and-research</member>
              <member>religion</member>
              <member>search-engines</member>
              <member>sex-education</member>
              <member>shareware-and-freeware</member>
              <member>shopping</member>
              <member>social-networking</member>
              <member>society</member>
              <member>sports</member>
              <member>stock-advice-and-tools</member>
              <member>streaming-media</member>
              <member>swimsuits-and-intimate-apparel</member>
              <member>training-and-tools</member>
              <member>translation</member>
              <member>travel</member>
              <member>unknown</member>
              <member>weapons</member>
              <member>web-advertisements</member>
              <member>web-based-email</member>
              <member>web-hosting</member>
            </block>
          </credential-enforcement>
          <log-http-hdr-user-agent>yes</log-http-hdr-user-agent>
          <log-http-hdr-referer>yes</log-http-hdr-referer>
          <log-http-hdr-xff>yes</log-http-hdr-xff>
          <alert>
            <member>Allow</member>
            <member>abortion</member>
            <member>abused-drugs</member>
            <member>adult</member>
            <member>alcohol-and-tobacco</member>
            <member>auctions</member>
            <member>business-and-economy</member>
            <member>computer-and-internet-info</member>
            <member>content-delivery-networks</member>
            <member>copyright-infringement</member>
            <member>cryptocurrency</member>
            <member>dating</member>
            <member>dynamic-dns</member>
            <member>educational-institutions</member>
            <member>entertainment-and-arts</member>
            <member>extremism</member>
            <member>financial-services</member>
            <member>gambling</member>
            <member>games</member>
            <member>government</member>
            <member>hacking</member>
            <member>health-and-medicine</member>
            <member>high-risk</member>
            <member>home-and-garden</member>
            <member>hunting-and-fishing</member>
            <member>insufficient-content</member>
            <member>internet-communications-and-telephony</member>
            <member>internet-portals</member>
            <member>job-search</member>
            <member>legal</member>
            <member>low-risk</member>
            <member>medium-risk</member>
            <member>military</member>
            <member>motor-vehicles</member>
            <member>music</member>
            <member>newly-registered-domain</member>
            <member>news</member>
            <member>not-resolved</member>
            <member>nudity</member>
            <member>online-storage-and-backup</member>
            <member>parked</member>
            <member>peer-to-peer</member>
            <member>personal-sites-and-blogs</member>
            <member>philosophy-and-political-advocacy</member>
            <member>private-ip-addresses</member>
            <member>proxy-avoidance-and-anonymizers</member>
            <member>questionable</member>
            <member>real-estate</member>
            <member>recreation-and-hobbies</member>
            <member>reference-and-research</member>
            <member>religion</member>
            <member>search-engines</member>
            <member>sex-education</member>
            <member>shareware-and-freeware</member>
            <member>shopping</member>
            <member>social-networking</member>
            <member>society</member>
            <member>sports</member>
            <member>stock-advice-and-tools</member>
            <member>streaming-media</member>
            <member>swimsuits-and-intimate-apparel</member>
            <member>training-and-tools</member>
            <member>translation</member>
            <member>travel</member>
            <member>unknown</member>
            <member>weapons</member>
            <member>web-advertisements</member>
            <member>web-based-email</member>
            <member>web-hosting</member>
          </alert>
          <block>
            <member>Block</member>
            <member>command-and-control</member>
            <member>grayware</member>
            <member>malware</member>
            <member>phishing</member>
          </block>
          <mlav-engine-urlbased-enabled>
            <entry name="Phishing Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
            <entry name="Javascript Exploit Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
          </mlav-engine-urlbased-enabled>
        </entry>
    cmd: set
-   name: profiles_wildfire_analysis
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/wildfire-analysis
    element: |-
        <entry name="Outbound-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
        <entry name="Inbound-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
        <entry name="Internal-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
        <entry name="Alert-Only-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
    cmd: set
-   name: profile_group
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profile-group
    element: |-
        <entry name="Outbound">
          <virus>
            <member>Outbound-AV</member>
          </virus>
          <spyware>
            <member>Outbound-AS</member>
          </spyware>
          <vulnerability>
            <member>Outbound-VP</member>
          </vulnerability>
          <url-filtering>
            <member>Outbound-URL</member>
          </url-filtering>
          <file-blocking>
            <member>Outbound-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Outbound-WF</member>
          </wildfire-analysis>
        </entry>
        <entry name="Inbound">
          <virus>
            <member>Inbound-AV</member>
          </virus>
          <spyware>
            <member>Inbound-AS</member>
          </spyware>
          <vulnerability>
            <member>Inbound-VP</member>
          </vulnerability>
          <file-blocking>
            <member>Inbound-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Inbound-WF</member>
          </wildfire-analysis>
        </entry>
        <entry name="Internal">
          <virus>
            <member>Internal-AV</member>
          </virus>
          <spyware>
            <member>Internal-AS</member>
          </spyware>
          <vulnerability>
            <member>Internal-VP</member>
          </vulnerability>
          <file-blocking>
            <member>Internal-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Internal-WF</member>
          </wildfire-analysis>
        </entry>
        <entry name="Alert-Only">
          <virus>
            <member>Alert-Only-AV</member>
          </virus>
          <spyware>
            <member>Alert-Only-AS</member>
          </spyware>
          <vulnerability>
            <member>Alert-Only-VP</member>
          </vulnerability>
          <url-filtering>
            <member>Alert-Only-URL</member>
          </url-filtering>
          <file-blocking>
            <member>Alert-Only-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Alert-Only-WF</member>
          </wildfire-analysis>
        </entry>
        <entry name="default">
          <virus>
            <member>Outbound-AV</member>
          </virus>
          <spyware>
            <member>Outbound-AS</member>
          </spyware>
          <vulnerability>
            <member>Outbound-VP</member>
          </vulnerability>
          <url-filtering>
            <member>Outbound-URL</member>
          </url-filtering>
          <file-blocking>
            <member>Outbound-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Outbound-WF</member>
          </wildfire-analysis>
        </entry>
    cmd: set
-   name: default_security_rules
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/rulebase/default-security-rules
    element: |-

        <rules>
          <entry name="intrazone-default">
            <action>allow</action>
            <log-start>no</log-start>
            <log-end>yes</log-end>
            <profile-setting>
              <group>
                <member>Inbound</member>
              </group>
            </profile-setting>
            <log-setting>default</log-setting>
          </entry>
          <entry name="interzone-default">
            <action>drop</action>
            <log-start>no</log-start>
            <log-end>yes</log-end>
            <log-setting>default</log-setting>
          </entry>
        </rules>
    cmd: set
-   name: security_rules
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/rulebase
    element: |-
        <security>
          {%- if INCLUDE_PAN_EDL == 'no' %}
          <rules/>
          {%- elif INCLUDE_PAN_EDL == 'yes' %}
          <rules>
            <entry name="Outbound Block Rule">
              <description>Block outbound sessions with destination address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses.</description>
              <to>
                <member>any</member>
              </to>
              <from>
                <member>any</member>
              </from>
              <source>
                <member>any</member>
              </source>
              <destination>
                <member>panw-highrisk-ip-list</member>
                <member>panw-known-ip-list</member>
                <member>panw-bulletproof-ip-list</member>
              </destination>
              <source-user>
                <member>any</member>
              </source-user>
              <category>
                <member>any</member>
              </category>
              <application>
                <member>any</member>
              </application>
              <service>
                <member>any</member>
              </service>
              <hip-profiles>
                <member>any</member>
              </hip-profiles>
              <action>deny</action>
              <log-setting>default</log-setting>
              <tag>
                <member>Outbound</member>
              </tag>
            </entry>
            <entry name="Inbound Block Rule">
              <description>Block inbound sessions with source address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses.</description>
              <to>
                <member>any</member>
              </to>
              <from>
                <member>any</member>
              </from>
              <source>
                <member>panw-highrisk-ip-list</member>
                <member>panw-known-ip-list</member>
                <member>panw-bulletproof-ip-list</member>
              </source>
              <destination>
                <member>any</member>
              </destination>
              <source-user>
                <member>any</member>
              </source-user>
              <category>
                <member>any</member>
              </category>
              <application>
                <member>any</member>
              </application>
              <service>
                <member>any</member>
              </service>
              <hip-profiles>
                <member>any</member>
              </hip-profiles>
              <action>deny</action>
              <log-setting>default</log-setting>
              <tag>
                <member>Inbound</member>
              </tag>
            </entry>
          </rules>
          {%- endif %}
        </security>
    cmd: set
-   name: decryption_rules
    xpath: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/rulebase/decryption
    element: |-
        <rules>
          <entry name="NO-Decrypt URL Categories">
            <category>
              <member>financial-services</member>
              <member>government</member>
              <member>health-and-medicine</member>
              <member>Custom-No-Decrypt</member>
            </category>
            <service>
              <member>any</member>
            </service>
            <type>
              <ssl-forward-proxy/>
            </type>
            <from>
              <member>any</member>
            </from>
            <to>
              <member>any</member>
            </to>
            <source>
              <member>any</member>
            </source>
            <destination>
              <member>any</member>
            </destination>
            <source-user>
              <member>any</member>
            </source-user>
            <profile>Recommended_Decryption_Profile</profile>
            <action>no-decrypt</action>
            <disabled>yes</disabled>
            <description>This rule does not do Decryption.  This rule is validating SSL Protocol Communications.</description>
          </entry>
        </rules>
    cmd: set
-   name: zone_protection_profile
    xpath: /config/devices/entry[@name='localhost.localdomain']/network/profiles/zone-protection-profile
    element: |-
        <entry name="Recommended_Zone_Protection">
          <flood>
            <tcp-syn>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </tcp-syn>
            <icmp>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </icmp>
            <icmpv6>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </icmpv6>
            <other-ip>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </other-ip>
            <udp>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </udp>
          </flood>
          <scan>
            <entry name="8001">
              <action>
                <alert/>
              </action>
              <interval>2</interval>
              <threshold>100</threshold>
            </entry>
            <entry name="8002">
              <action>
                <alert/>
              </action>
              <interval>10</interval>
              <threshold>100</threshold>
            </entry>
            <entry name="8003">
              <action>
                <alert/>
              </action>
              <interval>2</interval>
              <threshold>100</threshold>
            </entry>
          </scan>
          <discard-ip-spoof>yes</discard-ip-spoof>
          <discard-malformed-option>yes</discard-malformed-option>
          <remove-tcp-timestamp>yes</remove-tcp-timestamp>
          <strip-tcp-fast-open-and-data>no</strip-tcp-fast-open-and-data>
          <strip-mptcp-option>global</strip-mptcp-option>
        </entry>
    cmd: set
-   name: reports
    xpath: /config/shared/reports
    element: |-
        <entry name="Host-visit malicious sites plus">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Host-visit malicious sites plus</caption>
          <frequency>daily</frequency>
          <query>(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)</query>
          <type>
            <url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
                <member>category</member>
                <member>action</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </url>
          </type>
        </entry>
        <entry name="Hosts visit malicious sites">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Hosts visit malicious sites</caption>
          <frequency>daily</frequency>
          <query>(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)</query>
          <type>
            <url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </url>
          </type>
        </entry>
        <entry name="Hosts visit questionable sites">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Hosts visit questionable sites</caption>
          <frequency>daily</frequency>
          <query>(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)</query>
          <type>
            <url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </url>
          </type>
        </entry>
        <entry name="Host-visit quest sites plus">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Host-visit quest sites plus</caption>
          <frequency>daily</frequency>
          <query>(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)</query>
          <description>Detail of hosts visiting questionable URLs</description>
          <type>
            <url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
                <member>category</member>
                <member>action</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </url>
          </type>
        </entry>
        <entry name="Wildfire malicious verdicts">
          <period>last-30-calendar-days</period>
          <topn>500</topn>
          <topm>10</topm>
          <caption>Wildfire malicious verdicts</caption>
          <frequency>daily</frequency>
          <query>(app neq smtp) and (category neq benign)</query>
          <description>Files uploaded or downloaded that were later found to be malicious. This is a summary. Act on real-time email.</description>
          <type>
            <wildfire>
              <sortby>repeatcnt</sortby>
              <aggregate-by>
                <member>filedigest</member>
                <member>container-of-app</member>
                <member>app</member>
                <member>category</member>
                <member>filetype</member>
                <member>rule</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </wildfire>
          </type>
        </entry>
        <entry name="Wildfire verdicts SMTP">
          <period>last-30-calendar-days</period>
          <topn>500</topn>
          <topm>10</topm>
          <caption>Wildfire verdicts SMTP</caption>
          <frequency>daily</frequency>
          <query>(app eq smtp) and (category neq benign)</query>
          <description>Links sent from emails found to be malicious. </description>
          <type>
            <wildfire>
              <sortby>repeatcnt</sortby>
              <aggregate-by>
                <member>filedigest</member>
                <member>container-of-app</member>
                <member>app</member>
                <member>category</member>
                <member>filetype</member>
                <member>rule</member>
                <member>subject</member>
                <member>sender</member>
                <member>recipient</member>
                <member>misc</member>
              </aggregate-by>
            </wildfire>
          </type>
        </entry>
        <entry name="Clients sinkholed">
          <period>last-30-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Clients sinkholed</caption>
          <query>(rule eq 'DNS Sinkhole Block')</query>
          <frequency>daily</frequency>
          <type>
            <traffic>
              <sortby>repeatcnt</sortby>
              <group-by>from</group-by>
              <aggregate-by>
                <member>src</member>
                <member>srcuser</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </traffic>
          </type>
        </entry>
    cmd: set
-   name: report_group_simple
    xpath: /config/shared/report-group
    element: |-
        <entry name="Possible Compromise">
          <custom-widget>
            <entry name="1">
              <custom-report>Clients sinkholed</custom-report>
            </entry>
            <entry name="2">
              <custom-report>Wildfire malicious verdicts</custom-report>
            </entry>
            <entry name="3">
              <custom-report>Wildfire verdicts SMTP</custom-report>
            </entry>
            <entry name="4">
              <custom-report>Hosts visit malicious sites</custom-report>
            </entry>
            <entry name="5">
              <custom-report>Host-visit malicious sites plus</custom-report>
            </entry>
            <entry name="6">
              <custom-report>Hosts visit questionable sites</custom-report>
            </entry>
            <entry name="7">
              <custom-report>Host-visit quest sites plus</custom-report>
            </entry>
          </custom-widget>
          <title-page>yes</title-page>
          <variable>
            <entry name="title">
              <value>Possible Compromise</value>
            </entry>
          </variable>
        </entry>
    cmd: set
